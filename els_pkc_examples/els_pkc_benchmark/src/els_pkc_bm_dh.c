/*
 * Copyright 2024 NXP
 * All rights reserved.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 */

#include "els_pkc_bm_dh.h"

/*******************************************************************************
 * Definitions
 ******************************************************************************/
#define WEIER256_BIT_LENGTH (256U)
#define WEIER384_BIT_LENGTH (384U)
#define WEIER521_BIT_LENGTH (521U)
#define MCUX_PKC_MIN(a, b)  ((a) < (b) ? (a) : (b))

#define POINT_MULT(pointmult_params, pSession)                                              \
    do                                                                                      \
    {                                                                                       \
        MCUX_CSSL_FP_FUNCTION_CALL_BEGIN(retEccPointMult, tokenEccPointMult,                \
                                         mcuxClEcc_PointMult(pSession, &pointmult_params)); \
        if (MCUX_CSSL_FP_FUNCTION_CALLED(mcuxClEcc_PointMult) != tokenEccPointMult)         \
        {                                                                                   \
            PRINTF("[Error] ECC Point multiplication token mismatch at Bob\r\n");           \
            return MCUXCLEXAMPLE_STATUS_ERROR;                                              \
        }                                                                                   \
        if (MCUXCLECC_STATUS_INVALID_PARAMS == retEccPointMult)                             \
        {                                                                                   \
            PRINTF("[Error] ECC Point multiplication invalid params at Bob\r\n");           \
            return MCUXCLEXAMPLE_STATUS_ERROR;                                              \
        }                                                                                   \
        else if (MCUXCLECC_STATUS_OK != retEccPointMult)                                    \
        {                                                                                   \
            PRINTF("[Error] ECC Point multiplication failed at Bob\r\n");                   \
            return MCUXCLEXAMPLE_STATUS_ERROR;                                              \
        }                                                                                   \
        MCUX_CSSL_FP_FUNCTION_CALL_END();                                                   \
    } while (0)

#define ECDH_HANDSHAKE(pointmult_params, pointMultParamsBobKey, pSession)                        \
    do                                                                                           \
    {                                                                                            \
        POINT_MULT(pointmult_params, pSession);                                                  \
        MCUX_CSSL_FP_FUNCTION_CALL_BEGIN(retEccPointMult, tokenEccPointMult,                     \
                                         mcuxClEcc_PointMult(pSession, &pointMultParamsBobKey)); \
        if (MCUX_CSSL_FP_FUNCTION_CALLED(mcuxClEcc_PointMult) != tokenEccPointMult)              \
        {                                                                                        \
            PRINTF("[Error] ECC Point multiplication token mismatch at Bob\r\n");                \
            return MCUXCLEXAMPLE_STATUS_ERROR;                                                   \
        }                                                                                        \
        if (MCUXCLECC_STATUS_INVALID_PARAMS == retEccPointMult)                                  \
        {                                                                                        \
            PRINTF("[Error] ECC Point multiplication invalid params at Bob1\r\n");               \
            return MCUXCLEXAMPLE_STATUS_ERROR;                                                   \
        }                                                                                        \
        else if (MCUXCLECC_STATUS_OK != retEccPointMult)                                         \
        {                                                                                        \
            PRINTF("[Error] ECC Point multiplication failed at Bob\r\n");                        \
            return MCUXCLEXAMPLE_STATUS_ERROR;                                                   \
        }                                                                                        \
        MCUX_CSSL_FP_FUNCTION_CALL_END();                                                        \
    } while (0);

/*******************************************************************************
 * Prototypes
 ******************************************************************************/

/*******************************************************************************
 * Variables
 ******************************************************************************/
/* Private key input for ECC-Weier */
static uint8_t s_PrivateKeyInputWeier256Bob[32U] = {
    0xE9U, 0x46U, 0xFFU, 0x12U, 0xFFU, 0xB2U, 0xE7U, 0xBAU, 0x2CU, 0x5DU, 0x3AU, 0xAFU, 0x7DU, 0x9AU, 0xEEU, 0xE2U,
    0x00U, 0x59U, 0x7AU, 0xABU, 0x20U, 0xCAU, 0xB0U, 0xF9U, 0x6BU, 0xD4U, 0x84U, 0x75U, 0x3DU, 0x78U, 0xFEU, 0xF4U};

static uint8_t s_PrivateKeyInputWeier384Bob[48U] = {
    0x8EU, 0x49U, 0xBFU, 0x1CU, 0x5DU, 0x9CU, 0xBEU, 0x73U, 0xD5U, 0xD3U, 0xDCU, 0xD7U, 0xBBU, 0x57U, 0x6AU, 0x2BU,
    0xDEU, 0x17U, 0xB1U, 0xAAU, 0xA7U, 0xCCU, 0x31U, 0xD0U, 0x24U, 0x10U, 0xB0U, 0xE6U, 0x9FU, 0xF7U, 0x42U, 0x4BU,
    0xA6U, 0x58U, 0x87U, 0x41U, 0x6AU, 0x04U, 0x14U, 0x43U, 0x4CU, 0x25U, 0x5CU, 0xECU, 0x9DU, 0x84U, 0x36U, 0x88U};

static uint8_t s_PrivateKeyInputWeier521Bob[66U] = {
    0x00U, 0xA8U, 0x14U, 0x1AU, 0xE2U, 0xF5U, 0x5FU, 0xFCU, 0x6EU, 0x4AU, 0x39U, 0xF2U, 0x0FU, 0x3DU,
    0x53U, 0x47U, 0x19U, 0xB0U, 0x6BU, 0x32U, 0xC7U, 0xBDU, 0xEAU, 0x46U, 0x40U, 0x58U, 0xE2U, 0xC6U,
    0x73U, 0xD4U, 0xE2U, 0x35U, 0x73U, 0x8FU, 0x0FU, 0x49U, 0x08U, 0x2AU, 0x8FU, 0xE7U, 0xAAU, 0x47U,
    0x1DU, 0x2AU, 0x73U, 0x61U, 0xCAU, 0x2CU, 0xF7U, 0x60U, 0x6EU, 0x85U, 0xDBU, 0xD7U, 0x03U, 0xBEU,
    0xA6U, 0x3FU, 0xB3U, 0xCDU, 0x8CU, 0x78U, 0x72U, 0xA9U, 0x4BU, 0x20U};

/* Public key input for ECC-Weier */
static uint8_t s_PublicKeyInputWeier256Bob[64U] = {
    0x52U, 0x03U, 0x46U, 0xA7U, 0x4AU, 0x71U, 0xE0U, 0x4DU, 0x39U, 0xFEU, 0x4BU, 0x20U, 0x1BU, 0xF7U, 0x4CU, 0x92U,
    0xB6U, 0xBEU, 0x9FU, 0x88U, 0x11U, 0x1EU, 0x7CU, 0x31U, 0x63U, 0x13U, 0xB3U, 0xFCU, 0x94U, 0x85U, 0xDAU, 0xD9U,
    0x70U, 0x7AU, 0xBDU, 0x51U, 0x8EU, 0x51U, 0xC2U, 0xD6U, 0x56U, 0x54U, 0xC4U, 0xD9U, 0x86U, 0xE7U, 0x76U, 0x9FU,
    0x4EU, 0xA1U, 0xD9U, 0x37U, 0x39U, 0xF7U, 0xC3U, 0xABU, 0x73U, 0x89U, 0xBDU, 0x30U, 0x03U, 0x17U, 0x9BU, 0xD9U};

static uint8_t s_PublicKeyInputWeier384Bob[96U] = {
    0x89U, 0xF1U, 0xB7U, 0x32U, 0x2DU, 0x68U, 0xEFU, 0x8AU, 0x73U, 0x17U, 0xB2U, 0x98U, 0x72U, 0xF0U, 0xE1U, 0x10U,
    0x8AU, 0xFFU, 0xF7U, 0x19U, 0x53U, 0x83U, 0x79U, 0x4AU, 0x1CU, 0x94U, 0x08U, 0xA2U, 0x16U, 0xE6U, 0x18U, 0x0AU,
    0xF3U, 0xC3U, 0x7FU, 0x69U, 0x6AU, 0xE8U, 0xCBU, 0xF0U, 0x34U, 0x8DU, 0x14U, 0x8AU, 0x9AU, 0x22U, 0x75U, 0x1DU,
    0x57U, 0x39U, 0x14U, 0x3EU, 0xE8U, 0xAFU, 0xB6U, 0x51U, 0x35U, 0x83U, 0x6CU, 0xBDU, 0x35U, 0x97U, 0x4DU, 0x67U,
    0x53U, 0xB7U, 0x12U, 0x7DU, 0xAAU, 0xDDU, 0xB2U, 0xEEU, 0x0AU, 0x60U, 0x39U, 0xFBU, 0xF0U, 0xE5U, 0x77U, 0x8CU,
    0x76U, 0xD0U, 0x6CU, 0x28U, 0xBBU, 0x66U, 0xEAU, 0xA9U, 0x4EU, 0xA3U, 0x14U, 0x6BU, 0x53U, 0xA6U, 0xA6U, 0x22U};

static uint8_t s_PublicKeyInputWeier521Bob[132U] = {
    0x00U, 0x4BU, 0x29U, 0xF5U, 0xEFU, 0x68U, 0xBBU, 0x53U, 0x47U, 0xA5U, 0x4AU, 0x76U, 0x6AU, 0x09U, 0x80U,
    0xD6U, 0x1FU, 0x45U, 0xA1U, 0x90U, 0xD8U, 0xBBU, 0x4EU, 0xFDU, 0x88U, 0x90U, 0x5FU, 0xA6U, 0xABU, 0x6AU,
    0x6DU, 0x6BU, 0x5EU, 0xFAU, 0x5BU, 0x3EU, 0xB4U, 0xBCU, 0x4CU, 0xB4U, 0x98U, 0x6BU, 0xF0U, 0xB5U, 0x99U,
    0xACU, 0xB1U, 0xAAU, 0xD8U, 0x62U, 0xADU, 0xE0U, 0xCAU, 0x7AU, 0x22U, 0x4AU, 0xE0U, 0xC5U, 0xAEU, 0x6DU,
    0x6EU, 0x9EU, 0x97U, 0x88U, 0xDDU, 0xA0U, 0x01U, 0x01U, 0x08U, 0x21U, 0x53U, 0x9BU, 0xDAU, 0x45U, 0x0FU,
    0xCBU, 0x07U, 0x93U, 0x8EU, 0xFCU, 0x8EU, 0xE5U, 0x56U, 0xF8U, 0x8AU, 0xE0U, 0xC8U, 0x06U, 0xA8U, 0x7CU,
    0xD2U, 0x1AU, 0x1EU, 0x82U, 0x8EU, 0x3AU, 0xECU, 0x00U, 0x5EU, 0x0DU, 0x90U, 0x5FU, 0x13U, 0xF5U, 0x50U,
    0xE1U, 0xA1U, 0x95U, 0x6DU, 0x76U, 0x80U, 0xEEU, 0x9AU, 0xC5U, 0x88U, 0xBEU, 0x42U, 0x85U, 0x5CU, 0x15U,
    0xDDU, 0xCBU, 0x97U, 0xA9U, 0xFAU, 0x1BU, 0x24U, 0x91U, 0x98U, 0xA5U, 0x49U, 0x8EU};

/* Private key input for ECC-Weier */
static uint8_t s_PrivateKeyInputWeier256Alice[32U] = {
    0x10U, 0x69U, 0x26U, 0x12U, 0xAEU, 0xDEU, 0x15U, 0xC2U, 0xC5U, 0x82U, 0x41U, 0x5BU, 0xB8U, 0xDEU, 0xF5U, 0xABU,
    0x6CU, 0xFDU, 0x6CU, 0xD5U, 0x05U, 0x27U, 0x70U, 0xACU, 0xF2U, 0xFAU, 0x71U, 0x3DU, 0x01U, 0xC1U, 0x9DU, 0x4EU};

static uint8_t s_PrivateKeyInputWeier384Alice[48U] = {
    0xE5U, 0x86U, 0xEEU, 0x87U, 0xCFU, 0x1DU, 0x30U, 0xB3U, 0x5EU, 0xDEU, 0x97U, 0x76U, 0xA0U, 0x5BU, 0x37U, 0xDEU,
    0x57U, 0x4AU, 0x35U, 0x65U, 0x70U, 0x24U, 0x9CU, 0xB0U, 0xBCU, 0x8DU, 0x86U, 0xF8U, 0x90U, 0x87U, 0x9FU, 0xB7U,
    0x7CU, 0x2DU, 0x29U, 0xFEU, 0x08U, 0x30U, 0xA2U, 0x21U, 0x0FU, 0xD0U, 0xF6U, 0x3FU, 0x4BU, 0xE3U, 0xF4U, 0x40U};

static uint8_t s_PrivateKeyInputWeier521Alice[66U] = {
    0x00U, 0xE3U, 0xCCU, 0xB7U, 0xDCU, 0x9BU, 0x83U, 0xBFU, 0x33U, 0x1AU, 0x87U, 0x99U, 0x01U, 0xECU,
    0xD0U, 0x20U, 0x09U, 0x7AU, 0x87U, 0x57U, 0x7FU, 0x28U, 0x28U, 0x5AU, 0xE6U, 0x75U, 0x61U, 0xC7U,
    0x09U, 0x53U, 0xDEU, 0x26U, 0x07U, 0x56U, 0xB6U, 0xEEU, 0x1AU, 0x4CU, 0x1FU, 0x1EU, 0x33U, 0xFBU,
    0x69U, 0x5EU, 0xCAU, 0xE4U, 0x37U, 0x68U, 0x77U, 0x02U, 0xF0U, 0xC4U, 0x1BU, 0x71U, 0x1DU, 0xA2U,
    0xFAU, 0x26U, 0x95U, 0xC7U, 0xD8U, 0xFFU, 0x1AU, 0x37U, 0x70U, 0x99U};

/* Public key input for ECC-Weier */
static uint8_t s_PublicKeyInputWeier256Alice[64U] = {
    0x27U, 0x78U, 0x9EU, 0x21U, 0x7DU, 0x91U, 0x50U, 0x1AU, 0xBEU, 0xD0U, 0x42U, 0xACU, 0x2AU, 0xDBU, 0xE6U, 0xAFU,
    0x42U, 0x94U, 0xE3U, 0x4CU, 0x6BU, 0x9BU, 0xF0U, 0xCAU, 0x8CU, 0xE0U, 0xE4U, 0xA7U, 0xDEU, 0xBCU, 0xC4U, 0xD3U,
    0xF2U, 0x63U, 0x7AU, 0xE2U, 0x05U, 0x23U, 0x21U, 0xCCU, 0xECU, 0xCAU, 0x60U, 0x5EU, 0x40U, 0xF1U, 0x48U, 0x4AU,
    0x7EU, 0x38U, 0x9DU, 0x86U, 0x21U, 0xA5U, 0xFCU, 0x94U, 0xA7U, 0x0CU, 0xB5U, 0xF2U, 0xABU, 0xA1U, 0x6BU, 0x5DU};

static uint8_t s_PublicKeyInputWeier384Alice[96U] = {
    0x10U, 0xF9U, 0xF8U, 0xBEU, 0x95U, 0x95U, 0x0EU, 0xF7U, 0x07U, 0x1EU, 0x84U, 0xC8U, 0x06U, 0xB5U, 0x19U, 0x2EU,
    0xA1U, 0x04U, 0x50U, 0x4FU, 0x5CU, 0xADU, 0x82U, 0x2DU, 0x85U, 0x7AU, 0x8EU, 0x9CU, 0x97U, 0x5CU, 0xF9U, 0x12U,
    0xBBU, 0x35U, 0x17U, 0x13U, 0xDEU, 0x77U, 0x64U, 0xEFU, 0xE7U, 0x80U, 0xADU, 0x6AU, 0x52U, 0x1DU, 0xA9U, 0x93U,
    0x39U, 0xC7U, 0x7DU, 0x76U, 0xFAU, 0x6FU, 0xD5U, 0x4FU, 0x8AU, 0x82U, 0x66U, 0xFAU, 0x14U, 0x35U, 0xA5U, 0x83U,
    0x06U, 0xFAU, 0xF5U, 0x23U, 0xECU, 0x8CU, 0x71U, 0x3FU, 0x7AU, 0xDCU, 0x7EU, 0x86U, 0x03U, 0xBFU, 0xE1U, 0x57U,
    0x8DU, 0x49U, 0x2DU, 0xDBU, 0x49U, 0xD0U, 0xCDU, 0xB8U, 0x51U, 0x07U, 0xD6U, 0xE2U, 0x02U, 0x0FU, 0x7AU, 0x94U};

static uint8_t s_PublicKeyInputWeier521Alice[132U] = {
    0x00U, 0x4DU, 0xE9U, 0xC6U, 0xAFU, 0x37U, 0xD4U, 0x53U, 0x79U, 0xD8U, 0xACU, 0xE3U, 0xF7U, 0xD0U, 0x73U,
    0xC7U, 0xFBU, 0x7AU, 0xB1U, 0x71U, 0x2FU, 0xA9U, 0xC7U, 0x47U, 0x0CU, 0x06U, 0xD8U, 0xF8U, 0x52U, 0x9DU,
    0x53U, 0xF8U, 0x05U, 0xDFU, 0x43U, 0x8BU, 0x77U, 0x80U, 0x21U, 0x5AU, 0x23U, 0x08U, 0xCDU, 0xD7U, 0x8EU,
    0x06U, 0xB8U, 0x0DU, 0xC3U, 0x2CU, 0xA8U, 0x00U, 0x44U, 0x72U, 0xC2U, 0xC5U, 0x57U, 0xD8U, 0x83U, 0xACU,
    0x95U, 0x1DU, 0x41U, 0xD3U, 0x65U, 0xF4U, 0x00U, 0x9FU, 0xBAU, 0x60U, 0x1FU, 0x9EU, 0xADU, 0x2CU, 0x2BU,
    0xC0U, 0x0EU, 0xC0U, 0xD9U, 0x06U, 0xEEU, 0x1BU, 0xABU, 0xB4U, 0x06U, 0x89U, 0x30U, 0xE0U, 0x05U, 0x22U,
    0xD0U, 0x00U, 0x18U, 0x78U, 0xC4U, 0x8DU, 0x60U, 0xB2U, 0x9FU, 0x11U, 0xF9U, 0x5BU, 0x9DU, 0x19U, 0x02U,
    0x2FU, 0x3FU, 0xA5U, 0xB1U, 0xFDU, 0xB9U, 0x4BU, 0xA2U, 0xCFU, 0x1FU, 0x3BU, 0xC2U, 0x84U, 0xAEU, 0x8EU,
    0x4AU, 0xC7U, 0x69U, 0x8EU, 0x29U, 0x8CU, 0x40U, 0xF4U, 0xC1U, 0xDDU, 0x0CU, 0xA5U};

/* d_A * Q_B */
static uint8_t s_AlicePointMult256[64U] = {
    0x8BU, 0x5EU, 0x66U, 0x67U, 0xE4U, 0x75U, 0xB3U, 0xE8U, 0xBCU, 0x0BU, 0xCEU, 0x98U, 0xA8U, 0x99U, 0xCFU, 0x82U,
    0xDCU, 0x70U, 0xE8U, 0x78U, 0xC3U, 0x8AU, 0xACU, 0x2EU, 0x85U, 0xC2U, 0xEAU, 0x4CU, 0x59U, 0x8BU, 0x9FU, 0xA1U,
    0x3DU, 0x17U, 0xCFU, 0x4FU, 0xD7U, 0x33U, 0x16U, 0xCBU, 0xABU, 0x9EU, 0x61U, 0x4AU, 0xFDU, 0x90U, 0x9FU, 0x97U,
    0xADU, 0x69U, 0x83U, 0xE4U, 0xD0U, 0xBDU, 0x97U, 0x48U, 0x1DU, 0xAFU, 0x3DU, 0x52U, 0x3CU, 0x4AU, 0x4DU, 0x58U};

static uint8_t s_AlicePointMult384[96U] = {
    0xADU, 0x33U, 0x08U, 0x83U, 0x7EU, 0x17U, 0xAAU, 0x00U, 0xC1U, 0x1FU, 0x10U, 0xBDU, 0x8CU, 0xC4U, 0x51U, 0xAFU,
    0x92U, 0x46U, 0x01U, 0xBDU, 0xA3U, 0xB7U, 0x1DU, 0x62U, 0xE2U, 0xF6U, 0x64U, 0x1DU, 0x09U, 0x1BU, 0xADU, 0x3CU,
    0xA4U, 0x2AU, 0x64U, 0x1BU, 0x55U, 0x4EU, 0xDFU, 0x8FU, 0x1CU, 0x39U, 0x93U, 0xACU, 0xEDU, 0x1CU, 0xE3U, 0x53U,
    0xDEU, 0xDBU, 0x38U, 0x99U, 0x68U, 0x7DU, 0xBCU, 0xAEU, 0x93U, 0xC4U, 0x54U, 0xDEU, 0x76U, 0x2AU, 0x2AU, 0xF2U,
    0xC2U, 0x48U, 0x14U, 0xFEU, 0x8DU, 0xE8U, 0xAAU, 0x52U, 0x84U, 0xD1U, 0x8DU, 0x21U, 0x32U, 0x7EU, 0xD1U, 0x77U,
    0xD0U, 0x91U, 0xC2U, 0x64U, 0x4FU, 0xC1U, 0x78U, 0xDAU, 0x2CU, 0x37U, 0xBCU, 0x49U, 0x9AU, 0x12U, 0xD6U, 0xD2U};

static uint8_t s_AlicePointMult521[132U] = {
    0x01U, 0x95U, 0xA9U, 0xC1U, 0x23U, 0x47U, 0x1EU, 0x42U, 0x00U, 0x88U, 0x96U, 0x39U, 0x3CU, 0xD8U, 0x17U,
    0x32U, 0x4DU, 0xEFU, 0xCEU, 0x18U, 0xF1U, 0xB0U, 0x00U, 0x17U, 0xF4U, 0x54U, 0x4BU, 0xC3U, 0x0FU, 0xAEU,
    0xE2U, 0xA8U, 0x7FU, 0x7DU, 0x23U, 0x2BU, 0xE4U, 0x6DU, 0x97U, 0xECU, 0xFEU, 0x94U, 0x20U, 0x89U, 0xA3U,
    0x42U, 0x8BU, 0x3CU, 0xB0U, 0x26U, 0xC6U, 0xA0U, 0x70U, 0x5BU, 0x3FU, 0x7FU, 0x50U, 0x34U, 0x31U, 0xD9U,
    0x86U, 0x1EU, 0x3CU, 0x77U, 0x3AU, 0x0DU, 0x01U, 0x53U, 0xF3U, 0x67U, 0x5AU, 0xF8U, 0x12U, 0x3BU, 0xCEU,
    0x38U, 0x35U, 0x5BU, 0xF7U, 0x2DU, 0x0DU, 0xFBU, 0x54U, 0x51U, 0xF9U, 0x6CU, 0xF1U, 0x6DU, 0x49U, 0x78U,
    0x81U, 0xAEU, 0xE5U, 0xE6U, 0x0FU, 0x6FU, 0x36U, 0x2BU, 0xECU, 0x69U, 0x8CU, 0x9CU, 0x4EU, 0x85U, 0x40U,
    0x7DU, 0xD1U, 0x45U, 0xE9U, 0xF5U, 0x98U, 0x7BU, 0xF8U, 0x5EU, 0x03U, 0xB9U, 0x83U, 0xD7U, 0xCAU, 0xE5U,
    0x46U, 0x42U, 0x84U, 0x2BU, 0x5DU, 0x48U, 0xFDU, 0x90U, 0x78U, 0xBAU, 0x19U, 0x7CU};

/* Domain parameters for ECC-Weier */
static uint8_t s_BN_P256_P[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x01U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U,
    0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static uint8_t s_BN_P256_A[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x01U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U,
    0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static uint8_t s_BN_P256_B[WEIER256_BIT_LENGTH / 8U] = {
    0x5AU, 0xC6U, 0x35U, 0xD8U, 0xAAU, 0x3AU, 0x93U, 0xE7U, 0xB3U, 0xEBU, 0xBDU, 0x55U, 0x76U, 0x98U, 0x86U, 0xBCU,
    0x65U, 0x1DU, 0x06U, 0xB0U, 0xCCU, 0x53U, 0xB0U, 0xF6U, 0x3BU, 0xCEU, 0x3CU, 0x3EU, 0x27U, 0xD2U, 0x60U, 0x4BU};

static uint8_t s_BN_P256_G[2U * WEIER256_BIT_LENGTH / 8U] = {
    0x6BU, 0x17U, 0xD1U, 0xF2U, 0xE1U, 0x2CU, 0x42U, 0x47U, 0xF8U, 0xBCU, 0xE6U, 0xE5U, 0x63U, 0xA4U, 0x40U, 0xF2U,
    0x77U, 0x03U, 0x7DU, 0x81U, 0x2DU, 0xEBU, 0x33U, 0xA0U, 0xF4U, 0xA1U, 0x39U, 0x45U, 0xD8U, 0x98U, 0xC2U, 0x96U,
    0x4FU, 0xE3U, 0x42U, 0xE2U, 0xFEU, 0x1AU, 0x7FU, 0x9BU, 0x8EU, 0xE7U, 0xEBU, 0x4AU, 0x7CU, 0x0FU, 0x9EU, 0x16U,
    0x2BU, 0xCEU, 0x33U, 0x57U, 0x6BU, 0x31U, 0x5EU, 0xCEU, 0xCBU, 0xB6U, 0x40U, 0x68U, 0x37U, 0xBFU, 0x51U, 0xF5U};

static uint8_t s_BN_P256_N[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xBCU, 0xE6U, 0xFAU, 0xADU, 0xA7U, 0x17U, 0x9EU, 0x84U, 0xF3U, 0xB9U, 0xCAU, 0xC2U, 0xFCU, 0x63U, 0x25U, 0x51U};

static uint8_t s_BN_P384_P[48U] = {0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFEU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static uint8_t s_BN_P384_A[48U] = {0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFEU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static uint8_t s_BN_P384_B[48U] = {0xB3U, 0x31U, 0x2FU, 0xA7U, 0xE2U, 0x3EU, 0xE7U, 0xE4U, 0x98U, 0x8EU, 0x05U, 0x6BU,
                                   0xE3U, 0xF8U, 0x2DU, 0x19U, 0x18U, 0x1DU, 0x9CU, 0x6EU, 0xFEU, 0x81U, 0x41U, 0x12U,
                                   0x03U, 0x14U, 0x08U, 0x8FU, 0x50U, 0x13U, 0x87U, 0x5AU, 0xC6U, 0x56U, 0x39U, 0x8DU,
                                   0x8AU, 0x2EU, 0xD1U, 0x9DU, 0x2AU, 0x85U, 0xC8U, 0xEDU, 0xD3U, 0xECU, 0x2AU, 0xEFU};

static uint8_t s_BN_P384_G[96U] = {
    0xAAU, 0x87U, 0xCAU, 0x22U, 0xBEU, 0x8BU, 0x05U, 0x37U, 0x8EU, 0xB1U, 0xC7U, 0x1EU, 0xF3U, 0x20U, 0xADU, 0x74U,
    0x6EU, 0x1DU, 0x3BU, 0x62U, 0x8BU, 0xA7U, 0x9BU, 0x98U, 0x59U, 0xF7U, 0x41U, 0xE0U, 0x82U, 0x54U, 0x2AU, 0x38U,
    0x55U, 0x02U, 0xF2U, 0x5DU, 0xBFU, 0x55U, 0x29U, 0x6CU, 0x3AU, 0x54U, 0x5EU, 0x38U, 0x72U, 0x76U, 0x0AU, 0xB7U,
    0x36U, 0x17U, 0xDEU, 0x4AU, 0x96U, 0x26U, 0x2CU, 0x6FU, 0x5DU, 0x9EU, 0x98U, 0xBFU, 0x92U, 0x92U, 0xDCU, 0x29U,
    0xF8U, 0xF4U, 0x1DU, 0xBDU, 0x28U, 0x9AU, 0x14U, 0x7CU, 0xE9U, 0xDAU, 0x31U, 0x13U, 0xB5U, 0xF0U, 0xB8U, 0xC0U,
    0x0AU, 0x60U, 0xB1U, 0xCEU, 0x1DU, 0x7EU, 0x81U, 0x9DU, 0x7AU, 0x43U, 0x1DU, 0x7CU, 0x90U, 0xEAU, 0x0EU, 0x5FU};

static uint8_t s_BN_P384_N[48U] = {0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xC7U, 0x63U, 0x4DU, 0x81U, 0xF4U, 0x37U, 0x2DU, 0xDFU, 0x58U, 0x1AU, 0x0DU, 0xB2U,
                                   0x48U, 0xB0U, 0xA7U, 0x7AU, 0xECU, 0xECU, 0x19U, 0x6AU, 0xCCU, 0xC5U, 0x29U, 0x73U};

static uint8_t s_BN_P521_P[66U] = {0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static uint8_t s_BN_P521_A[66U] = {0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static uint8_t s_BN_P521_B[66U] = {0x00U, 0x51U, 0x95U, 0x3EU, 0xB9U, 0x61U, 0x8EU, 0x1CU, 0x9AU, 0x1FU, 0x92U,
                                   0x9AU, 0x21U, 0xA0U, 0xB6U, 0x85U, 0x40U, 0xEEU, 0xA2U, 0xDAU, 0x72U, 0x5BU,
                                   0x99U, 0xB3U, 0x15U, 0xF3U, 0xB8U, 0xB4U, 0x89U, 0x91U, 0x8EU, 0xF1U, 0x09U,
                                   0xE1U, 0x56U, 0x19U, 0x39U, 0x51U, 0xECU, 0x7EU, 0x93U, 0x7BU, 0x16U, 0x52U,
                                   0xC0U, 0xBDU, 0x3BU, 0xB1U, 0xBFU, 0x07U, 0x35U, 0x73U, 0xDFU, 0x88U, 0x3DU,
                                   0x2CU, 0x34U, 0xF1U, 0xEFU, 0x45U, 0x1FU, 0xD4U, 0x6BU, 0x50U, 0x3FU, 0x00U};

static uint8_t s_BN_P521_G[2U * 66U] = {
    0x00U, 0xC6U, 0x85U, 0x8EU, 0x06U, 0xB7U, 0x04U, 0x04U, 0xE9U, 0xCDU, 0x9EU, 0x3EU, 0xCBU, 0x66U, 0x23U,
    0x95U, 0xB4U, 0x42U, 0x9CU, 0x64U, 0x81U, 0x39U, 0x05U, 0x3FU, 0xB5U, 0x21U, 0xF8U, 0x28U, 0xAFU, 0x60U,
    0x6BU, 0x4DU, 0x3DU, 0xBAU, 0xA1U, 0x4BU, 0x5EU, 0x77U, 0xEFU, 0xE7U, 0x59U, 0x28U, 0xFEU, 0x1DU, 0xC1U,
    0x27U, 0xA2U, 0xFFU, 0xA8U, 0xDEU, 0x33U, 0x48U, 0xB3U, 0xC1U, 0x85U, 0x6AU, 0x42U, 0x9BU, 0xF9U, 0x7EU,
    0x7EU, 0x31U, 0xC2U, 0xE5U, 0xBDU, 0x66U, 0x01U, 0x18U, 0x39U, 0x29U, 0x6AU, 0x78U, 0x9AU, 0x3BU, 0xC0U,
    0x04U, 0x5CU, 0x8AU, 0x5FU, 0xB4U, 0x2CU, 0x7DU, 0x1BU, 0xD9U, 0x98U, 0xF5U, 0x44U, 0x49U, 0x57U, 0x9BU,
    0x44U, 0x68U, 0x17U, 0xAFU, 0xBDU, 0x17U, 0x27U, 0x3EU, 0x66U, 0x2CU, 0x97U, 0xEEU, 0x72U, 0x99U, 0x5EU,
    0xF4U, 0x26U, 0x40U, 0xC5U, 0x50U, 0xB9U, 0x01U, 0x3FU, 0xADU, 0x07U, 0x61U, 0x35U, 0x3CU, 0x70U, 0x86U,
    0xA2U, 0x72U, 0xC2U, 0x40U, 0x88U, 0xBEU, 0x94U, 0x76U, 0x9FU, 0xD1U, 0x66U, 0x50U};

static uint8_t s_BN_P521_N[66U] = {0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
                                   0xFAU, 0x51U, 0x86U, 0x87U, 0x83U, 0xBFU, 0x2FU, 0x96U, 0x6BU, 0x7FU, 0xCCU,
                                   0x01U, 0x48U, 0xF7U, 0x09U, 0xA5U, 0xD0U, 0x3BU, 0xB5U, 0xC9U, 0xB8U, 0x89U,
                                   0x9CU, 0x47U, 0xAEU, 0xBBU, 0x6FU, 0xB7U, 0x1EU, 0x91U, 0x38U, 0x64U, 0x09U};

/* Domain parameters for ECC-Weier stored in flash */
static const uint8_t s_BN_P256_P_Flash[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x01U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U,
    0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static const uint8_t s_BN_P256_A_Flash[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x01U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U,
    0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static const uint8_t s_BN_P256_B_Flash[WEIER256_BIT_LENGTH / 8U] = {
    0x5AU, 0xC6U, 0x35U, 0xD8U, 0xAAU, 0x3AU, 0x93U, 0xE7U, 0xB3U, 0xEBU, 0xBDU, 0x55U, 0x76U, 0x98U, 0x86U, 0xBCU,
    0x65U, 0x1DU, 0x06U, 0xB0U, 0xCCU, 0x53U, 0xB0U, 0xF6U, 0x3BU, 0xCEU, 0x3CU, 0x3EU, 0x27U, 0xD2U, 0x60U, 0x4BU};

static const uint8_t s_BN_P256_G_Flash[2U * WEIER256_BIT_LENGTH / 8U] = {
    0x6BU, 0x17U, 0xD1U, 0xF2U, 0xE1U, 0x2CU, 0x42U, 0x47U, 0xF8U, 0xBCU, 0xE6U, 0xE5U, 0x63U, 0xA4U, 0x40U, 0xF2U,
    0x77U, 0x03U, 0x7DU, 0x81U, 0x2DU, 0xEBU, 0x33U, 0xA0U, 0xF4U, 0xA1U, 0x39U, 0x45U, 0xD8U, 0x98U, 0xC2U, 0x96U,
    0x4FU, 0xE3U, 0x42U, 0xE2U, 0xFEU, 0x1AU, 0x7FU, 0x9BU, 0x8EU, 0xE7U, 0xEBU, 0x4AU, 0x7CU, 0x0FU, 0x9EU, 0x16U,
    0x2BU, 0xCEU, 0x33U, 0x57U, 0x6BU, 0x31U, 0x5EU, 0xCEU, 0xCBU, 0xB6U, 0x40U, 0x68U, 0x37U, 0xBFU, 0x51U, 0xF5U};

static const uint8_t s_BN_P256_N_Flash[WEIER256_BIT_LENGTH / 8U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xBCU, 0xE6U, 0xFAU, 0xADU, 0xA7U, 0x17U, 0x9EU, 0x84U, 0xF3U, 0xB9U, 0xCAU, 0xC2U, 0xFCU, 0x63U, 0x25U, 0x51U};

static const uint8_t s_BN_P384_P_Flash[48U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFEU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static const uint8_t s_BN_P384_A_Flash[48U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFEU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0x00U, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static const uint8_t s_BN_P384_B_Flash[48U] = {
    0xB3U, 0x31U, 0x2FU, 0xA7U, 0xE2U, 0x3EU, 0xE7U, 0xE4U, 0x98U, 0x8EU, 0x05U, 0x6BU, 0xE3U, 0xF8U, 0x2DU, 0x19U,
    0x18U, 0x1DU, 0x9CU, 0x6EU, 0xFEU, 0x81U, 0x41U, 0x12U, 0x03U, 0x14U, 0x08U, 0x8FU, 0x50U, 0x13U, 0x87U, 0x5AU,
    0xC6U, 0x56U, 0x39U, 0x8DU, 0x8AU, 0x2EU, 0xD1U, 0x9DU, 0x2AU, 0x85U, 0xC8U, 0xEDU, 0xD3U, 0xECU, 0x2AU, 0xEFU};

static const uint8_t s_BN_P384_G_Flash[96U] = {
    0xAAU, 0x87U, 0xCAU, 0x22U, 0xBEU, 0x8BU, 0x05U, 0x37U, 0x8EU, 0xB1U, 0xC7U, 0x1EU, 0xF3U, 0x20U, 0xADU, 0x74U,
    0x6EU, 0x1DU, 0x3BU, 0x62U, 0x8BU, 0xA7U, 0x9BU, 0x98U, 0x59U, 0xF7U, 0x41U, 0xE0U, 0x82U, 0x54U, 0x2AU, 0x38U,
    0x55U, 0x02U, 0xF2U, 0x5DU, 0xBFU, 0x55U, 0x29U, 0x6CU, 0x3AU, 0x54U, 0x5EU, 0x38U, 0x72U, 0x76U, 0x0AU, 0xB7U,
    0x36U, 0x17U, 0xDEU, 0x4AU, 0x96U, 0x26U, 0x2CU, 0x6FU, 0x5DU, 0x9EU, 0x98U, 0xBFU, 0x92U, 0x92U, 0xDCU, 0x29U,
    0xF8U, 0xF4U, 0x1DU, 0xBDU, 0x28U, 0x9AU, 0x14U, 0x7CU, 0xE9U, 0xDAU, 0x31U, 0x13U, 0xB5U, 0xF0U, 0xB8U, 0xC0U,
    0x0AU, 0x60U, 0xB1U, 0xCEU, 0x1DU, 0x7EU, 0x81U, 0x9DU, 0x7AU, 0x43U, 0x1DU, 0x7CU, 0x90U, 0xEAU, 0x0EU, 0x5FU};

static const uint8_t s_BN_P384_N_Flash[48U] = {
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xC7U, 0x63U, 0x4DU, 0x81U, 0xF4U, 0x37U, 0x2DU, 0xDFU,
    0x58U, 0x1AU, 0x0DU, 0xB2U, 0x48U, 0xB0U, 0xA7U, 0x7AU, 0xECU, 0xECU, 0x19U, 0x6AU, 0xCCU, 0xC5U, 0x29U, 0x73U};

static const uint8_t s_BN_P521_P_Flash[66U] = {
    0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU};

static const uint8_t s_BN_P521_A_Flash[66U] = {
    0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFCU};

static const uint8_t s_BN_P521_B_Flash[66U] = {
    0x00U, 0x51U, 0x95U, 0x3EU, 0xB9U, 0x61U, 0x8EU, 0x1CU, 0x9AU, 0x1FU, 0x92U, 0x9AU, 0x21U, 0xA0U,
    0xB6U, 0x85U, 0x40U, 0xEEU, 0xA2U, 0xDAU, 0x72U, 0x5BU, 0x99U, 0xB3U, 0x15U, 0xF3U, 0xB8U, 0xB4U,
    0x89U, 0x91U, 0x8EU, 0xF1U, 0x09U, 0xE1U, 0x56U, 0x19U, 0x39U, 0x51U, 0xECU, 0x7EU, 0x93U, 0x7BU,
    0x16U, 0x52U, 0xC0U, 0xBDU, 0x3BU, 0xB1U, 0xBFU, 0x07U, 0x35U, 0x73U, 0xDFU, 0x88U, 0x3DU, 0x2CU,
    0x34U, 0xF1U, 0xEFU, 0x45U, 0x1FU, 0xD4U, 0x6BU, 0x50U, 0x3FU, 0x00U};

static const uint8_t s_BN_P521_G_Flash[2U * 66U] = {
    0x00U, 0xC6U, 0x85U, 0x8EU, 0x06U, 0xB7U, 0x04U, 0x04U, 0xE9U, 0xCDU, 0x9EU, 0x3EU, 0xCBU, 0x66U, 0x23U,
    0x95U, 0xB4U, 0x42U, 0x9CU, 0x64U, 0x81U, 0x39U, 0x05U, 0x3FU, 0xB5U, 0x21U, 0xF8U, 0x28U, 0xAFU, 0x60U,
    0x6BU, 0x4DU, 0x3DU, 0xBAU, 0xA1U, 0x4BU, 0x5EU, 0x77U, 0xEFU, 0xE7U, 0x59U, 0x28U, 0xFEU, 0x1DU, 0xC1U,
    0x27U, 0xA2U, 0xFFU, 0xA8U, 0xDEU, 0x33U, 0x48U, 0xB3U, 0xC1U, 0x85U, 0x6AU, 0x42U, 0x9BU, 0xF9U, 0x7EU,
    0x7EU, 0x31U, 0xC2U, 0xE5U, 0xBDU, 0x66U, 0x01U, 0x18U, 0x39U, 0x29U, 0x6AU, 0x78U, 0x9AU, 0x3BU, 0xC0U,
    0x04U, 0x5CU, 0x8AU, 0x5FU, 0xB4U, 0x2CU, 0x7DU, 0x1BU, 0xD9U, 0x98U, 0xF5U, 0x44U, 0x49U, 0x57U, 0x9BU,
    0x44U, 0x68U, 0x17U, 0xAFU, 0xBDU, 0x17U, 0x27U, 0x3EU, 0x66U, 0x2CU, 0x97U, 0xEEU, 0x72U, 0x99U, 0x5EU,
    0xF4U, 0x26U, 0x40U, 0xC5U, 0x50U, 0xB9U, 0x01U, 0x3FU, 0xADU, 0x07U, 0x61U, 0x35U, 0x3CU, 0x70U, 0x86U,
    0xA2U, 0x72U, 0xC2U, 0x40U, 0x88U, 0xBEU, 0x94U, 0x76U, 0x9FU, 0xD1U, 0x66U, 0x50U};

static const uint8_t s_BN_P521_N_Flash[66U] = {
    0x01U, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU,
    0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFFU, 0xFAU, 0x51U, 0x86U, 0x87U, 0x83U, 0xBFU, 0x2FU, 0x96U, 0x6BU,
    0x7FU, 0xCCU, 0x01U, 0x48U, 0xF7U, 0x09U, 0xA5U, 0xD0U, 0x3BU, 0xB5U, 0xC9U, 0xB8U, 0x89U, 0x9CU,
    0x47U, 0xAEU, 0xBBU, 0x6FU, 0xB7U, 0x1EU, 0x91U, 0x38U, 0x64U, 0x09U};

/* Private key input for ECC-Weier stored in flash */
static const uint8_t s_PrivateKeyInputWeier256BobFlash[32U] = {
    0xE9U, 0x46U, 0xFFU, 0x12U, 0xFFU, 0xB2U, 0xE7U, 0xBAU, 0x2CU, 0x5DU, 0x3AU, 0xAFU, 0x7DU, 0x9AU, 0xEEU, 0xE2U,
    0x00U, 0x59U, 0x7AU, 0xABU, 0x20U, 0xCAU, 0xB0U, 0xF9U, 0x6BU, 0xD4U, 0x84U, 0x75U, 0x3DU, 0x78U, 0xFEU, 0xF4U};

static const uint8_t s_PrivateKeyInputWeier384BobFlash[48U] = {
    0x8EU, 0x49U, 0xBFU, 0x1CU, 0x5DU, 0x9CU, 0xBEU, 0x73U, 0xD5U, 0xD3U, 0xDCU, 0xD7U, 0xBBU, 0x57U, 0x6AU, 0x2BU,
    0xDEU, 0x17U, 0xB1U, 0xAAU, 0xA7U, 0xCCU, 0x31U, 0xD0U, 0x24U, 0x10U, 0xB0U, 0xE6U, 0x9FU, 0xF7U, 0x42U, 0x4BU,
    0xA6U, 0x58U, 0x87U, 0x41U, 0x6AU, 0x04U, 0x14U, 0x43U, 0x4CU, 0x25U, 0x5CU, 0xECU, 0x9DU, 0x84U, 0x36U, 0x88U};

static const uint8_t s_PrivateKeyInputWeier521BobFlash[66U] = {
    0x00U, 0xA8U, 0x14U, 0x1AU, 0xE2U, 0xF5U, 0x5FU, 0xFCU, 0x6EU, 0x4AU, 0x39U, 0xF2U, 0x0FU, 0x3DU,
    0x53U, 0x47U, 0x19U, 0xB0U, 0x6BU, 0x32U, 0xC7U, 0xBDU, 0xEAU, 0x46U, 0x40U, 0x58U, 0xE2U, 0xC6U,
    0x73U, 0xD4U, 0xE2U, 0x35U, 0x73U, 0x8FU, 0x0FU, 0x49U, 0x08U, 0x2AU, 0x8FU, 0xE7U, 0xAAU, 0x47U,
    0x1DU, 0x2AU, 0x73U, 0x61U, 0xCAU, 0x2CU, 0xF7U, 0x60U, 0x6EU, 0x85U, 0xDBU, 0xD7U, 0x03U, 0xBEU,
    0xA6U, 0x3FU, 0xB3U, 0xCDU, 0x8CU, 0x78U, 0x72U, 0xA9U, 0x4BU, 0x20U};

/* Public key input for ECC-Weier stored in flash */
static const uint8_t s_PublicKeyInputWeier256BobFlash[64U] = {
    0x52U, 0x03U, 0x46U, 0xA7U, 0x4AU, 0x71U, 0xE0U, 0x4DU, 0x39U, 0xFEU, 0x4BU, 0x20U, 0x1BU, 0xF7U, 0x4CU, 0x92U,
    0xB6U, 0xBEU, 0x9FU, 0x88U, 0x11U, 0x1EU, 0x7CU, 0x31U, 0x63U, 0x13U, 0xB3U, 0xFCU, 0x94U, 0x85U, 0xDAU, 0xD9U,
    0x70U, 0x7AU, 0xBDU, 0x51U, 0x8EU, 0x51U, 0xC2U, 0xD6U, 0x56U, 0x54U, 0xC4U, 0xD9U, 0x86U, 0xE7U, 0x76U, 0x9FU,
    0x4EU, 0xA1U, 0xD9U, 0x37U, 0x39U, 0xF7U, 0xC3U, 0xABU, 0x73U, 0x89U, 0xBDU, 0x30U, 0x03U, 0x17U, 0x9BU, 0xD9U};

static const uint8_t s_PublicKeyInputWeier384BobFlash[96U] = {
    0x89U, 0xF1U, 0xB7U, 0x32U, 0x2DU, 0x68U, 0xEFU, 0x8AU, 0x73U, 0x17U, 0xB2U, 0x98U, 0x72U, 0xF0U, 0xE1U, 0x10U,
    0x8AU, 0xFFU, 0xF7U, 0x19U, 0x53U, 0x83U, 0x79U, 0x4AU, 0x1CU, 0x94U, 0x08U, 0xA2U, 0x16U, 0xE6U, 0x18U, 0x0AU,
    0xF3U, 0xC3U, 0x7FU, 0x69U, 0x6AU, 0xE8U, 0xCBU, 0xF0U, 0x34U, 0x8DU, 0x14U, 0x8AU, 0x9AU, 0x22U, 0x75U, 0x1DU,
    0x57U, 0x39U, 0x14U, 0x3EU, 0xE8U, 0xAFU, 0xB6U, 0x51U, 0x35U, 0x83U, 0x6CU, 0xBDU, 0x35U, 0x97U, 0x4DU, 0x67U,
    0x53U, 0xB7U, 0x12U, 0x7DU, 0xAAU, 0xDDU, 0xB2U, 0xEEU, 0x0AU, 0x60U, 0x39U, 0xFBU, 0xF0U, 0xE5U, 0x77U, 0x8CU,
    0x76U, 0xD0U, 0x6CU, 0x28U, 0xBBU, 0x66U, 0xEAU, 0xA9U, 0x4EU, 0xA3U, 0x14U, 0x6BU, 0x53U, 0xA6U, 0xA6U, 0x22U};

static const uint8_t s_PublicKeyInputWeier521BobFlash[132U] = {
    0x00U, 0x4BU, 0x29U, 0xF5U, 0xEFU, 0x68U, 0xBBU, 0x53U, 0x47U, 0xA5U, 0x4AU, 0x76U, 0x6AU, 0x09U, 0x80U,
    0xD6U, 0x1FU, 0x45U, 0xA1U, 0x90U, 0xD8U, 0xBBU, 0x4EU, 0xFDU, 0x88U, 0x90U, 0x5FU, 0xA6U, 0xABU, 0x6AU,
    0x6DU, 0x6BU, 0x5EU, 0xFAU, 0x5BU, 0x3EU, 0xB4U, 0xBCU, 0x4CU, 0xB4U, 0x98U, 0x6BU, 0xF0U, 0xB5U, 0x99U,
    0xACU, 0xB1U, 0xAAU, 0xD8U, 0x62U, 0xADU, 0xE0U, 0xCAU, 0x7AU, 0x22U, 0x4AU, 0xE0U, 0xC5U, 0xAEU, 0x6DU,
    0x6EU, 0x9EU, 0x97U, 0x88U, 0xDDU, 0xA0U, 0x01U, 0x01U, 0x08U, 0x21U, 0x53U, 0x9BU, 0xDAU, 0x45U, 0x0FU,
    0xCBU, 0x07U, 0x93U, 0x8EU, 0xFCU, 0x8EU, 0xE5U, 0x56U, 0xF8U, 0x8AU, 0xE0U, 0xC8U, 0x06U, 0xA8U, 0x7CU,
    0xD2U, 0x1AU, 0x1EU, 0x82U, 0x8EU, 0x3AU, 0xECU, 0x00U, 0x5EU, 0x0DU, 0x90U, 0x5FU, 0x13U, 0xF5U, 0x50U,
    0xE1U, 0xA1U, 0x95U, 0x6DU, 0x76U, 0x80U, 0xEEU, 0x9AU, 0xC5U, 0x88U, 0xBEU, 0x42U, 0x85U, 0x5CU, 0x15U,
    0xDDU, 0xCBU, 0x97U, 0xA9U, 0xFAU, 0x1BU, 0x24U, 0x91U, 0x98U, 0xA5U, 0x49U, 0x8EU};

/* Private key input for ECC-Weier */
static const uint8_t s_PrivateKeyInputWeier256AliceFlash[32U] = {
    0x10U, 0x69U, 0x26U, 0x12U, 0xAEU, 0xDEU, 0x15U, 0xC2U, 0xC5U, 0x82U, 0x41U, 0x5BU, 0xB8U, 0xDEU, 0xF5U, 0xABU,
    0x6CU, 0xFDU, 0x6CU, 0xD5U, 0x05U, 0x27U, 0x70U, 0xACU, 0xF2U, 0xFAU, 0x71U, 0x3DU, 0x01U, 0xC1U, 0x9DU, 0x4EU};

static const uint8_t s_PrivateKeyInputWeier384AliceFlash[48U] = {
    0xE5U, 0x86U, 0xEEU, 0x87U, 0xCFU, 0x1DU, 0x30U, 0xB3U, 0x5EU, 0xDEU, 0x97U, 0x76U, 0xA0U, 0x5BU, 0x37U, 0xDEU,
    0x57U, 0x4AU, 0x35U, 0x65U, 0x70U, 0x24U, 0x9CU, 0xB0U, 0xBCU, 0x8DU, 0x86U, 0xF8U, 0x90U, 0x87U, 0x9FU, 0xB7U,
    0x7CU, 0x2DU, 0x29U, 0xFEU, 0x08U, 0x30U, 0xA2U, 0x21U, 0x0FU, 0xD0U, 0xF6U, 0x3FU, 0x4BU, 0xE3U, 0xF4U, 0x40U};

static const uint8_t s_PrivateKeyInputWeier521AliceFlash[66U] = {
    0x00U, 0xE3U, 0xCCU, 0xB7U, 0xDCU, 0x9BU, 0x83U, 0xBFU, 0x33U, 0x1AU, 0x87U, 0x99U, 0x01U, 0xECU,
    0xD0U, 0x20U, 0x09U, 0x7AU, 0x87U, 0x57U, 0x7FU, 0x28U, 0x28U, 0x5AU, 0xE6U, 0x75U, 0x61U, 0xC7U,
    0x09U, 0x53U, 0xDEU, 0x26U, 0x07U, 0x56U, 0xB6U, 0xEEU, 0x1AU, 0x4CU, 0x1FU, 0x1EU, 0x33U, 0xFBU,
    0x69U, 0x5EU, 0xCAU, 0xE4U, 0x37U, 0x68U, 0x77U, 0x02U, 0xF0U, 0xC4U, 0x1BU, 0x71U, 0x1DU, 0xA2U,
    0xFAU, 0x26U, 0x95U, 0xC7U, 0xD8U, 0xFFU, 0x1AU, 0x37U, 0x70U, 0x99U};

/* Public key input for ECC-Weier */
static const uint8_t s_PublicKeyInputWeier256AliceFlash[64U] = {
    0x27U, 0x78U, 0x9EU, 0x21U, 0x7DU, 0x91U, 0x50U, 0x1AU, 0xBEU, 0xD0U, 0x42U, 0xACU, 0x2AU, 0xDBU, 0xE6U, 0xAFU,
    0x42U, 0x94U, 0xE3U, 0x4CU, 0x6BU, 0x9BU, 0xF0U, 0xCAU, 0x8CU, 0xE0U, 0xE4U, 0xA7U, 0xDEU, 0xBCU, 0xC4U, 0xD3U,
    0xF2U, 0x63U, 0x7AU, 0xE2U, 0x05U, 0x23U, 0x21U, 0xCCU, 0xECU, 0xCAU, 0x60U, 0x5EU, 0x40U, 0xF1U, 0x48U, 0x4AU,
    0x7EU, 0x38U, 0x9DU, 0x86U, 0x21U, 0xA5U, 0xFCU, 0x94U, 0xA7U, 0x0CU, 0xB5U, 0xF2U, 0xABU, 0xA1U, 0x6BU, 0x5DU};

static const uint8_t s_PublicKeyInputWeier384AliceFlash[96U] = {
    0x10U, 0xF9U, 0xF8U, 0xBEU, 0x95U, 0x95U, 0x0EU, 0xF7U, 0x07U, 0x1EU, 0x84U, 0xC8U, 0x06U, 0xB5U, 0x19U, 0x2EU,
    0xA1U, 0x04U, 0x50U, 0x4FU, 0x5CU, 0xADU, 0x82U, 0x2DU, 0x85U, 0x7AU, 0x8EU, 0x9CU, 0x97U, 0x5CU, 0xF9U, 0x12U,
    0xBBU, 0x35U, 0x17U, 0x13U, 0xDEU, 0x77U, 0x64U, 0xEFU, 0xE7U, 0x80U, 0xADU, 0x6AU, 0x52U, 0x1DU, 0xA9U, 0x93U,
    0x39U, 0xC7U, 0x7DU, 0x76U, 0xFAU, 0x6FU, 0xD5U, 0x4FU, 0x8AU, 0x82U, 0x66U, 0xFAU, 0x14U, 0x35U, 0xA5U, 0x83U,
    0x06U, 0xFAU, 0xF5U, 0x23U, 0xECU, 0x8CU, 0x71U, 0x3FU, 0x7AU, 0xDCU, 0x7EU, 0x86U, 0x03U, 0xBFU, 0xE1U, 0x57U,
    0x8DU, 0x49U, 0x2DU, 0xDBU, 0x49U, 0xD0U, 0xCDU, 0xB8U, 0x51U, 0x07U, 0xD6U, 0xE2U, 0x02U, 0x0FU, 0x7AU, 0x94U};

static const uint8_t s_PublicKeyInputWeier521AliceFlash[132U] = {
    0x00U, 0x4DU, 0xE9U, 0xC6U, 0xAFU, 0x37U, 0xD4U, 0x53U, 0x79U, 0xD8U, 0xACU, 0xE3U, 0xF7U, 0xD0U, 0x73U,
    0xC7U, 0xFBU, 0x7AU, 0xB1U, 0x71U, 0x2FU, 0xA9U, 0xC7U, 0x47U, 0x0CU, 0x06U, 0xD8U, 0xF8U, 0x52U, 0x9DU,
    0x53U, 0xF8U, 0x05U, 0xDFU, 0x43U, 0x8BU, 0x77U, 0x80U, 0x21U, 0x5AU, 0x23U, 0x08U, 0xCDU, 0xD7U, 0x8EU,
    0x06U, 0xB8U, 0x0DU, 0xC3U, 0x2CU, 0xA8U, 0x00U, 0x44U, 0x72U, 0xC2U, 0xC5U, 0x57U, 0xD8U, 0x83U, 0xACU,
    0x95U, 0x1DU, 0x41U, 0xD3U, 0x65U, 0xF4U, 0x00U, 0x9FU, 0xBAU, 0x60U, 0x1FU, 0x9EU, 0xADU, 0x2CU, 0x2BU,
    0xC0U, 0x0EU, 0xC0U, 0xD9U, 0x06U, 0xEEU, 0x1BU, 0xABU, 0xB4U, 0x06U, 0x89U, 0x30U, 0xE0U, 0x05U, 0x22U,
    0xD0U, 0x00U, 0x18U, 0x78U, 0xC4U, 0x8DU, 0x60U, 0xB2U, 0x9FU, 0x11U, 0xF9U, 0x5BU, 0x9DU, 0x19U, 0x02U,
    0x2FU, 0x3FU, 0xA5U, 0xB1U, 0xFDU, 0xB9U, 0x4BU, 0xA2U, 0xCFU, 0x1FU, 0x3BU, 0xC2U, 0x84U, 0xAEU, 0x8EU,
    0x4AU, 0xC7U, 0x69U, 0x8EU, 0x29U, 0x8CU, 0x40U, 0xF4U, 0xC1U, 0xDDU, 0x0CU, 0xA5U};

/* d_A * Q_B from Flash */
static const uint8_t s_AlicePointMult256Flash[64U] = {
    0x8BU, 0x5EU, 0x66U, 0x67U, 0xE4U, 0x75U, 0xB3U, 0xE8U, 0xBCU, 0x0BU, 0xCEU, 0x98U, 0xA8U, 0x99U, 0xCFU, 0x82U,
    0xDCU, 0x70U, 0xE8U, 0x78U, 0xC3U, 0x8AU, 0xACU, 0x2EU, 0x85U, 0xC2U, 0xEAU, 0x4CU, 0x59U, 0x8BU, 0x9FU, 0xA1U,
    0x3DU, 0x17U, 0xCFU, 0x4FU, 0xD7U, 0x33U, 0x16U, 0xCBU, 0xABU, 0x9EU, 0x61U, 0x4AU, 0xFDU, 0x90U, 0x9FU, 0x97U,
    0xADU, 0x69U, 0x83U, 0xE4U, 0xD0U, 0xBDU, 0x97U, 0x48U, 0x1DU, 0xAFU, 0x3DU, 0x52U, 0x3CU, 0x4AU, 0x4DU, 0x58U};

static const uint8_t s_AlicePointMult384Flash[96U] = {
    0xADU, 0x33U, 0x08U, 0x83U, 0x7EU, 0x17U, 0xAAU, 0x00U, 0xC1U, 0x1FU, 0x10U, 0xBDU, 0x8CU, 0xC4U, 0x51U, 0xAFU,
    0x92U, 0x46U, 0x01U, 0xBDU, 0xA3U, 0xB7U, 0x1DU, 0x62U, 0xE2U, 0xF6U, 0x64U, 0x1DU, 0x09U, 0x1BU, 0xADU, 0x3CU,
    0xA4U, 0x2AU, 0x64U, 0x1BU, 0x55U, 0x4EU, 0xDFU, 0x8FU, 0x1CU, 0x39U, 0x93U, 0xACU, 0xEDU, 0x1CU, 0xE3U, 0x53U,
    0xDEU, 0xDBU, 0x38U, 0x99U, 0x68U, 0x7DU, 0xBCU, 0xAEU, 0x93U, 0xC4U, 0x54U, 0xDEU, 0x76U, 0x2AU, 0x2AU, 0xF2U,
    0xC2U, 0x48U, 0x14U, 0xFEU, 0x8DU, 0xE8U, 0xAAU, 0x52U, 0x84U, 0xD1U, 0x8DU, 0x21U, 0x32U, 0x7EU, 0xD1U, 0x77U,
    0xD0U, 0x91U, 0xC2U, 0x64U, 0x4FU, 0xC1U, 0x78U, 0xDAU, 0x2CU, 0x37U, 0xBCU, 0x49U, 0x9AU, 0x12U, 0xD6U, 0xD2U};

static const uint8_t s_AlicePointMult521Flash[132U] = {
    0x01U, 0x95U, 0xA9U, 0xC1U, 0x23U, 0x47U, 0x1EU, 0x42U, 0x00U, 0x88U, 0x96U, 0x39U, 0x3CU, 0xD8U, 0x17U,
    0x32U, 0x4DU, 0xEFU, 0xCEU, 0x18U, 0xF1U, 0xB0U, 0x00U, 0x17U, 0xF4U, 0x54U, 0x4BU, 0xC3U, 0x0FU, 0xAEU,
    0xE2U, 0xA8U, 0x7FU, 0x7DU, 0x23U, 0x2BU, 0xE4U, 0x6DU, 0x97U, 0xECU, 0xFEU, 0x94U, 0x20U, 0x89U, 0xA3U,
    0x42U, 0x8BU, 0x3CU, 0xB0U, 0x26U, 0xC6U, 0xA0U, 0x70U, 0x5BU, 0x3FU, 0x7FU, 0x50U, 0x34U, 0x31U, 0xD9U,
    0x86U, 0x1EU, 0x3CU, 0x77U, 0x3AU, 0x0DU, 0x01U, 0x53U, 0xF3U, 0x67U, 0x5AU, 0xF8U, 0x12U, 0x3BU, 0xCEU,
    0x38U, 0x35U, 0x5BU, 0xF7U, 0x2DU, 0x0DU, 0xFBU, 0x54U, 0x51U, 0xF9U, 0x6CU, 0xF1U, 0x6DU, 0x49U, 0x78U,
    0x81U, 0xAEU, 0xE5U, 0xE6U, 0x0FU, 0x6FU, 0x36U, 0x2BU, 0xECU, 0x69U, 0x8CU, 0x9CU, 0x4EU, 0x85U, 0x40U,
    0x7DU, 0xD1U, 0x45U, 0xE9U, 0xF5U, 0x98U, 0x7BU, 0xF8U, 0x5EU, 0x03U, 0xB9U, 0x83U, 0xD7U, 0xCAU, 0xE5U,
    0x46U, 0x42U, 0x84U, 0x2BU, 0x5DU, 0x48U, 0xFDU, 0x90U, 0x78U, 0xBAU, 0x19U, 0x7CU};

/*******************************************************************************
 * Code
 ******************************************************************************/
static mcuxClEcc_DomainParam_t get_domain_param_by_mode(uint32_t bit_length, bool data_from_ram)
{
    const uint32_t pByteLength = (bit_length + 7U) / 8U;
    const uint32_t nByteLength = (bit_length + 7U) / 8U;
    switch (bit_length)
    {
        case WEIER256_BIT_LENGTH:
            return (mcuxClEcc_DomainParam_t){.pA   = data_from_ram ? s_BN_P256_A : s_BN_P256_A_Flash,
                                             .pB   = data_from_ram ? s_BN_P256_B : s_BN_P256_B_Flash,
                                             .pG   = data_from_ram ? s_BN_P256_G : s_BN_P256_G_Flash,
                                             .pP   = data_from_ram ? s_BN_P256_P : s_BN_P256_P_Flash,
                                             .pN   = data_from_ram ? s_BN_P256_N : s_BN_P256_N_Flash,
                                             .misc = mcuxClEcc_DomainParam_misc_Pack(nByteLength, pByteLength)};
        case WEIER384_BIT_LENGTH:
            return (mcuxClEcc_DomainParam_t){.pA   = data_from_ram ? s_BN_P384_A : s_BN_P384_A_Flash,
                                             .pB   = data_from_ram ? s_BN_P384_B : s_BN_P384_B_Flash,
                                             .pG   = data_from_ram ? s_BN_P384_G : s_BN_P384_G_Flash,
                                             .pP   = data_from_ram ? s_BN_P384_P : s_BN_P384_P_Flash,
                                             .pN   = data_from_ram ? s_BN_P384_N : s_BN_P384_N_Flash,
                                             .misc = mcuxClEcc_DomainParam_misc_Pack(nByteLength, pByteLength)};
        case WEIER521_BIT_LENGTH:
            return (mcuxClEcc_DomainParam_t){.pA   = data_from_ram ? s_BN_P521_A : s_BN_P521_A_Flash,
                                             .pB   = data_from_ram ? s_BN_P521_B : s_BN_P521_B_Flash,
                                             .pG   = data_from_ram ? s_BN_P521_G : s_BN_P521_G_Flash,
                                             .pP   = data_from_ram ? s_BN_P521_P : s_BN_P521_P_Flash,
                                             .pN   = data_from_ram ? s_BN_P521_N : s_BN_P521_N_Flash,
                                             .misc = mcuxClEcc_DomainParam_misc_Pack(nByteLength, pByteLength)};
    }
    
    mcuxClEcc_DomainParam_t default_return;
    default_return.pA = NULL;
    return default_return;
}

bool exec_ecdh_point_mult(char *data_from, uint32_t bit_length, signature_algorithm_result *a_result)
{
    const uint32_t pByteLength = (bit_length + 7U) / 8U;
    const uint32_t nByteLength = (bit_length + 7U) / 8U;
    bool data_from_ram         = !strcmp(data_from, "RAM");

    mcuxClSession_Descriptor_t sessionDesc;
    mcuxClSession_Handle_t pSession = &sessionDesc;

    /* Allocate and initialize session */
    MCUXCLEXAMPLE_ALLOCATE_AND_INITIALIZE_SESSION(pSession, MCUXCLECC_POINTMULT_WACPU_SIZE,
                                                  MCUXCLECC_POINTMULT_WAPKC_SIZE(pByteLength, nByteLength));

    mcuxClEcc_DomainParam_t domain_param = get_domain_param_by_mode(bit_length, data_from_ram);
    uint8_t pResultBob[132U]             = {0U};
    mcuxClEcc_PointMult_Param_t pointmult_params;
    switch (bit_length)
    {
        case WEIER256_BIT_LENGTH:
        {
            pointmult_params = (mcuxClEcc_PointMult_Param_t){
                .curveParam = domain_param,
                .pScalar    = data_from_ram ? s_PrivateKeyInputWeier256Bob : s_PrivateKeyInputWeier256BobFlash,
                .pPoint     = data_from_ram ? s_PublicKeyInputWeier256Alice : s_PublicKeyInputWeier256AliceFlash,
                .pResult    = pResultBob,
                .optLen     = 0U};
            break;
        }
        case WEIER384_BIT_LENGTH:
        {
            pointmult_params = (mcuxClEcc_PointMult_Param_t){
                .curveParam = domain_param,
                .pScalar    = data_from_ram ? s_PrivateKeyInputWeier384Bob : s_PrivateKeyInputWeier384BobFlash,
                .pPoint     = data_from_ram ? s_PublicKeyInputWeier384Alice : s_PublicKeyInputWeier384AliceFlash,
                .pResult    = pResultBob,
                .optLen     = 0U};
            break;
        }
        case WEIER521_BIT_LENGTH:
        {
            pointmult_params = (mcuxClEcc_PointMult_Param_t){
                .curveParam = domain_param,
                .pScalar    = data_from_ram ? s_PrivateKeyInputWeier521Bob : s_PrivateKeyInputWeier521BobFlash,
                .pPoint     = data_from_ram ? s_PublicKeyInputWeier521Alice : s_PublicKeyInputWeier521AliceFlash,
                .pResult    = pResultBob,
                .optLen     = 0U};
            break;
        }
    }

    /* Point multiplication per second */
    a_result->signPerS = TIME_PUBLIC(POINT_MULT(pointmult_params, pSession));

    mcuxClEcc_PointMult_Param_t pointMultParamsBobKey;
    switch (bit_length)
    {
        case WEIER256_BIT_LENGTH:
        {
            pointMultParamsBobKey = (mcuxClEcc_PointMult_Param_t){
                .curveParam = domain_param,
                .pScalar    = data_from_ram ? s_PrivateKeyInputWeier256Bob : s_PrivateKeyInputWeier256BobFlash,
                .pPoint     = data_from_ram ? s_AlicePointMult256 : s_AlicePointMult256Flash,
                .pResult    = pResultBob,
                .optLen     = 0U};
            break;
        }
        case WEIER384_BIT_LENGTH:
        {
            pointMultParamsBobKey = (mcuxClEcc_PointMult_Param_t){
                .curveParam = domain_param,
                .pScalar    = data_from_ram ? s_PrivateKeyInputWeier384Bob : s_PrivateKeyInputWeier384BobFlash,
                .pPoint     = data_from_ram ? s_AlicePointMult384 : s_AlicePointMult384Flash,
                .pResult    = pResultBob,
                .optLen     = 0U};
            break;
        }
        case WEIER521_BIT_LENGTH:
        {
            pointMultParamsBobKey = (mcuxClEcc_PointMult_Param_t){
                .curveParam = domain_param,
                .pScalar    = data_from_ram ? s_PrivateKeyInputWeier521Bob : s_PrivateKeyInputWeier521BobFlash,
                .pPoint     = data_from_ram ? s_AlicePointMult521 : s_AlicePointMult521Flash,
                .pResult    = pResultBob,
                .optLen     = 0U};
            break;
        }
    }
    /* Secret key calculation per second */
    a_result->verifyPerS = TIME_PUBLIC(ECDH_HANDSHAKE(pointmult_params, pointMultParamsBobKey, pSession));

    /**************************************************************************/
    /* Clean session                                                          */
    /**************************************************************************/
    if (!mcuxClExample_Session_Clean(pSession))
    {
        return MCUXCLEXAMPLE_STATUS_ERROR;
    }
    return MCUXCLEXAMPLE_STATUS_OK;
}

void test_ecdh(char *code_from, char *data_from, uint32_t bit_length)
{
    if (!strcmp(code_from, "RAM") && !strcmp(data_from, "FLASH"))
        return;
    signature_algorithm_result a_result;
    strcpy(a_result.code, code_from);
    strcpy(a_result.data, data_from);
    exec_ecdh_point_mult(data_from, bit_length, &a_result);

    PRINT_DH_RESULT(a_result);
}

void run_tests_ecdh()
{
    char code_from[6U];
    strcpy(code_from, BOARD_IS_XIP() ? "FLASH" : "RAM");

    PRINTF("ECC-ECDH-WEIER-P256\r\n");
    test_ecdh(code_from, "FLASH", WEIER256_BIT_LENGTH);
    test_ecdh(code_from, "RAM", WEIER256_BIT_LENGTH);
    PRINTF("\r\n");

    PRINTF("ECC-ECDH-WEIER-P384\r\n");
    test_ecdh(code_from, "FLASH", WEIER384_BIT_LENGTH);
    test_ecdh(code_from, "RAM", WEIER384_BIT_LENGTH);
    PRINTF("\r\n");

    PRINTF("ECC-ECDH-WEIER-P521\r\n");
    test_ecdh(code_from, "FLASH", WEIER521_BIT_LENGTH);
    test_ecdh(code_from, "RAM", WEIER521_BIT_LENGTH);
    PRINTF("\r\n");
}
